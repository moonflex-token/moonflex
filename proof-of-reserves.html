<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Proof of Flex - XRPL</title>
</head>
<body>
  <h1>Proof of Flex</h1>
  <div id="balances">Loadingâ€¦</div>

  <script type="module">
    import { Client } from 'https://unpkg.com/xrpl/dist/npm/xrpl.mjs'

    async function fetchBalances() {
      try {
        const client = new Client('wss://s1.ripple.com')
        await client.connect()

        const wallets = [
          'rfnuwVEGrnsdAF9fqwYCuowAj7ZpJzkQNe',
          'rw8oU4Urf8GRJ4rR2yhA7EcsBWja6GGi3T'
        ]

        let html = '<ul>'
        for (const wallet of wallets) {
          // fetch issued-token balances
          const resp = await client.request({
            command: 'account_lines',
            account: wallet
          })
          html += `<li><strong>${wallet}</strong><ul>`
          for (const line of resp.result.lines) {
            html += `<li>${line.balance} ${line.currency} (issuer ${line.account})</li>`
          }
          html += '</ul></li>'
        }
        html += '</ul>'

        document.getElementById('balances').innerHTML = html
        await client.disconnect()
      } catch (e) {
        console.error(e)
        document.getElementById('balances').textContent =
          'Error fetching balances. Check console for details.'
      }
    }

    fetchBalances()
  </script>
</body>
</html>
